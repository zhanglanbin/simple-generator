<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper 
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="${generator.daoPackage}">

	<!-- 查询所有字段 -->
	<sql id="findAllColumns">
		${generator.findAllColumns}
	</sql>

	<!-- 查询所有, 模糊条件匹配 -->
	<sql id="findAllConditionVague">
		${generator.whereFindAllConditionVague}
	</sql>

	<!-- 查询所有, 精确条件匹配 -->
	<sql id="findAllCondition">
		${generator.whereFindAllCondition}
	</sql>

	<!-- 插入 -->
	<insert id="insert" parameterType="${generator.modelPackage}"
						useGeneratedKeys="true" keyProperty="${generator.modelPrimaryKey}" keyColumn="${generator.modelPrimaryKey}">
		<if test="${generator.modelVariableName}!=null">
			INSERT INTO ${generator.modelTableName} (
				${generator.sqlColumns}
			) VALUES (
				${generator.modelColumns}
			)
		</if>
	</insert>

	<!-- 动态插入 -->
	<insert id="insertDynamic" parameterType="${generator.modelPackage}"
						useGeneratedKeys="true" keyProperty="${generator.modelPrimaryKey}" keyColumn="${generator.modelPrimaryKey}">
		<if test="${generator.modelVariableName}!=null">
			INSERT INTO ${generator.modelTableName} 
			<set>
				${generator.dynamicAddModelColumns}
			</set>
		</if>
	</insert>

	<!-- 批量插入 -->
	<insert id="insertBatch" parameterType="java.util.List"
						useGeneratedKeys="true" keyProperty="${generator.modelPrimaryKey}" keyColumn="${generator.modelPrimaryKey}">
		<if test="${generator.modelListVariableName}!=null and ${generator.modelListVariableName}.size()>0">
			INSERT INTO ${generator.modelTableName} (
				${generator.sqlColumns}
			) VALUES 
			<foreach collection="${generator.modelListVariableName}" item="${generator.modelVariableName}" index="index" separator=",">
			(
				${generator.modelColumns}
			)
			</foreach>
		</if>
	</insert>

	<!-- 删除 By 主键 -->
	<delete id="deleteBy${generator.modelPrimaryKeyMethodName}" parameterType="${generator.modelPrimaryKeyJavaTypePackage}">
		<if test="${generator.modelPrimaryKey}!=null and ${generator.modelPrimaryKey}!=''">
			DELETE FROM ${generator.modelTableName}
			WHERE ${generator.modelSqlPrimaryKey}=${generator.modelPrimaryKeyMapper}
		</if>
	</delete>

	<!-- 批量删除 By 主键 -->
	<delete id="deleteBy${generator.modelPrimaryKeyListMethodName}" parameterType="java.util.List">
		<if test="${generator.modelPrimaryKeyVariableList}!=null and ${generator.modelPrimaryKeyVariableList}.size()>0">
			DELETE FROM ${generator.modelTableName}
			<where>
				${generator.modelSqlPrimaryKey} in
				<foreach collection="${generator.modelPrimaryKeyVariableList}" item="${generator.modelPrimaryKey}" open="(" separator="," close=")">
					#{${generator.modelPrimaryKey}}
				</foreach>
			</where>
		</if>
	</delete>

	<!-- 修改 By 主键 -->
	<update id="updateBy${generator.modelPrimaryKeyMethodName}" parameterType="${generator.modelPackage}">
		<if test="${generator.modelVariableName}.${generator.modelPrimaryKey}!=null and ${generator.modelVariableName}.${generator.modelPrimaryKey}!=''">
			UPDATE ${generator.modelTableName}
			<set>
				${generator.dynamicUpdateModelColumns}
			</set>
			WHERE ${generator.modelSqlPrimaryKey} = #{${generator.modelVariableName}.${generator.modelPrimaryKey}}
		</if>
	</update>

	<!-- 批量修改 By 主键 -->
	<update id="updateBy${generator.modelPrimaryKeyListMethodName}" parameterType="java.util.List">
		<if test="${generator.modelListVariableName}!=null and ${generator.modelListVariableName}.size()>0">
			<foreach collection="${generator.modelListVariableName}" item="${generator.modelVariableName}" index="index" open="" close="" separator=";">
				UPDATE ${generator.modelTableName}
				<set>
				${generator.batchDynamicUpdateModelColumns}
				</set>
				<where>
					${generator.modelSqlPrimaryKey} = #{${generator.modelVariableName}.${generator.modelPrimaryKey}}
				</where>
			</foreach>
		</if>
	</update>

	<!-- 主键查询 -->
	<select id="findBy${generator.modelPrimaryKeyMethodName}" parameterType="${generator.modelPrimaryKeyJavaTypePackage}" resultType="${generator.modelPackage}">
		<if test="${generator.modelPrimaryKey}!=null and ${generator.modelPrimaryKey}!=''">
			SELECT
				<include refid="findAllColumns"/>
			FROM ${generator.modelTableName}
			<where>
				${generator.modelSqlPrimaryKey} = ${generator.modelPrimaryKeyMapper}
			</where>
		</if>
	</select>

	<!-- 多个主键查询 -->
	<select id="findBy${generator.modelPrimaryKeyListMethodName}" parameterType="java.util.List" resultType="${generator.modelPackage}">
		<if test="${generator.modelPrimaryKeyVariableList}!=null and ${generator.modelPrimaryKeyVariableList}.size()>0">
			SELECT
				<include refid="findAllColumns"/>
			FROM ${generator.modelTableName}
			<where>
				id in
				<foreach collection="${generator.modelPrimaryKeyVariableList}" item="${generator.modelPrimaryKey}" index="index" open="(" separator="," close=")">
					#{${generator.modelPrimaryKey}}
				</foreach>
			</where>
		</if>
	</select>

	<!-- findList查询数据行数 -->
	<select id="findTotalRow" parameterType="${generator.modelQueryPackage}" resultType="int">
		SELECT
			COUNT(0)
		FROM ${generator.modelTableName}
		<!-- 是否精确匹配, 参数不等于null, 并且等于1, 为精确匹配 -->
		<if test="isAccurate!=null and isAccurate==1">
			<include refid="findAllCondition"/>
		</if>
		<!-- 是否模糊匹配, 参数等于null, 或者等于0, 为模糊匹配 -->
		<if test="isAccurate==null or isAccurate==0">
			<include refid="findAllConditionVague"/>
		</if>
	</select>

	<!-- findList查询多行数据(支持: 分页, 精确匹配, 模糊匹配) -->
	<select id="findList" parameterType="${generator.modelQueryPackage}"
										resultType="${generator.modelPackage}">
		SELECT
			<include refid="findAllColumns"/>
		FROM ${generator.modelTableName}
		<!-- 是否精确匹配, 参数不等于null, 并且等于1, 为精确匹配 -->
		<if test="isAccurate!=null and isAccurate==1">
			<include refid="findAllCondition"/>
		</if>
		<!-- 是否模糊匹配, 参数等于null, 或者等于0, 为模糊匹配 -->
		<if test="isAccurate==null or isAccurate==0">
			<include refid="findAllConditionVague"/>
		</if>
		<if test="endRowNumber>0">
			limit #{startRowNumber,jdbcType=INTEGER},#{endRowNumber,jdbcType=INTEGER}
		</if>
	</select>

	<!-- findList 动态查询多行数据(支持: 分页, 精确匹配, 模糊匹配, 自定义字段) -->
	<select id="findListByDynamicColumn" parameterType="${generator.modelQueryPackage}"
										resultType="${generator.modelPackage}">
		<if test="columnList!=null and columnList.size()>0">
			SELECT
				<foreach collection="columnList" item="column" index="index" separator=",">
					${generator.dynamicFindColumns}
				</foreach>
			FROM ${generator.modelTableName}
			<!-- 是否精确匹配, 参数不等于null, 并且等于1, 为精确匹配 -->
			<if test="isAccurate!=null and isAccurate==true">
				<include refid="findAllCondition"/>
			</if>
			<!-- 是否模糊匹配, 参数等于null, 或者等于0, 为模糊匹配 -->
			<if test="isAccurate==null or isAccurate==false">
				<include refid="findAllConditionVague"/>
			</if>
			<if test="endRowNumber>0">
				limit #{startRowNumber,jdbcType=INTEGER},#{endRowNumber,jdbcType=INTEGER}
			</if>
		</if>
	</select>
</mapper>